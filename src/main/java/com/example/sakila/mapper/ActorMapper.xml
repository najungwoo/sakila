<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.sakila.mapper.ActorMapper">

    <select id="selectActorList"
            parameterType="Map"
            resultType="com.example.sakila.vo.Actor">
        SELECT 
            actor_id AS actorId,
            first_name AS firstName,
            last_name AS lastName
        FROM actor
        <where>
            <if test="searchWord != null">
                first_name LIKE CONCAT('%', #{searchWord}, '%')
                OR last_name LIKE CONCAT('%', #{searchWord}, '%')
            </if>
        </where>
        ORDER BY first_name ASC
        LIMIT #{beginRow}, #{rowPerPage}
    </select>
    
    <!-- 전체 배우 수를 반환하는 selectActorCount 쿼리 추가 -->
    <select id="selectActorCount" parameterType="Map" resultType="int">
        SELECT COUNT(*) 
        FROM actor
        <where>
            <if test="searchWord != null">
                first_name LIKE CONCAT('%', #{searchWord}, '%')
                OR last_name LIKE CONCAT('%', #{searchWord}, '%')
            </if>
        </where>
    </select>

    <insert id="insertActor" parameterType="com.example.sakila.vo.Actor">
        <selectKey resultType="int" keyProperty="actorId" order="AFTER">
            SELECT LAST_INSERT_ID()    
        </selectKey>
    
        INSERT INTO actor (
            first_name, last_name
        ) VALUES (
            #{firstName}, #{lastName}
        )
    </insert>
</mapper>